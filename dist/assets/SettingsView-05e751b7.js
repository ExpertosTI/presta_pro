import{r,j as e,C as g,h as A}from"./index-868a038d.js";function T({systemSettings:t,setSystemSettings:x,collectors:c,addCollector:j,updateCollector:C,removeCollector:y,clients:N,assignCollectorToClient:w}){const[a,d]=r.useState({companyName:t.companyName||"Presta Pro",mainCurrency:t.mainCurrency||"DOP",defaultPenaltyRate:t.defaultPenaltyRate??5,themeColor:t.themeColor||"indigo",securityUser:t.securityUser||"admin",securityPassword:t.securityPassword||"1234"}),[i,p]=r.useState({name:"",phone:""}),[R,h]=r.useState(""),[n,m]=r.useState({name:"",phone:""}),[P,k]=r.useState("");r.useState("");const[l,u]=r.useState({name:"",username:"",password:""}),[f,v]=r.useState(""),E=s=>{s.preventDefault(),x({...t,companyName:a.companyName,mainCurrency:a.mainCurrency,defaultPenaltyRate:Number(a.defaultPenaltyRate)||0,themeColor:a.themeColor,enableRouteGpsNotification:t.enableRouteGpsNotification??!0,includeFutureInstallmentsInRoutes:t.includeFutureInstallmentsInRoutes??!0,securityUser:a.securityUser.trim()||"admin",securityPassword:a.securityPassword})},I=s=>{s.preventDefault(),i.name.trim()&&(j({...i}),p({name:"",phone:""}))},U=s=>{h(s.id),m({name:s.name||"",phone:s.phone||""})},F=s=>{n.name.trim()&&(C({id:s,name:n.name.trim(),phone:n.phone.trim()}),h(""),m({name:"",phone:""}))},D=s=>{y(s),P===s&&k("")},G=()=>{v("");const s=A(c,l.username,l.password,l.name);if(!s.success){v(s.error||"No se pudo registrar el usuario");return}j(s.userData),u({name:"",username:"",password:""})};return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Ajustes"}),e.jsxs(g,{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:"Configuración del Sistema"}),e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Nombre de la Empresa"}),e.jsx("input",{type:"text",className:"w-full p-2 border rounded-lg bg-slate-50",value:a.companyName,onChange:s=>d({...a,companyName:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Moneda Principal"}),e.jsxs("select",{className:"w-full p-2 border rounded-lg bg-slate-50",value:a.mainCurrency,onChange:s=>d({...a,mainCurrency:s.target.value}),children:[e.jsx("option",{value:"DOP",children:"Peso Dominicano (DOP)"}),e.jsx("option",{value:"USD",children:"Dólar Estadounidense (USD)"}),e.jsx("option",{value:"EUR",children:"Euro (EUR)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Tasa de Mora por Defecto (%)"}),e.jsx("input",{type:"number",className:"w-full p-2 border rounded-lg bg-slate-50",value:a.defaultPenaltyRate,onChange:s=>d({...a,defaultPenaltyRate:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Apariencia"}),e.jsx("div",{className:"flex gap-2",children:["indigo","blue","emerald","violet"].map(s=>e.jsx("button",{type:"button",onClick:()=>d({...a,themeColor:s}),className:`w-8 h-8 rounded-full border-2 ${a.themeColor===s?"border-slate-900":"border-transparent"} ${s==="indigo"?"bg-indigo-700":s==="blue"?"bg-blue-600":s==="emerald"?"bg-emerald-500":"bg-violet-500"}`},s))})]})]}),e.jsxs("div",{className:"mt-4 border-t border-slate-100 pt-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Usuarios de acceso (cobradores)"}),e.jsx("p",{className:"text-xs text-slate-500 mb-3",children:"Crea usuarios con nombre de acceso y contraseña para que los cobradores entren al sistema."}),f&&e.jsx("p",{className:"mb-2 text-xs text-red-600 bg-red-50 border border-red-200 rounded-lg px-3 py-2",children:f}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Nombre completo"}),e.jsx("input",{type:"text",className:"w-full p-2 border rounded-lg bg-slate-50",value:l.name,onChange:s=>u({...l,name:s.target.value}),placeholder:"Ej: Juan Pérez"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Usuario"}),e.jsx("input",{type:"text",className:"w-full p-2 border rounded-lg bg-slate-50",value:l.username,onChange:s=>u({...l,username:s.target.value}),placeholder:"usuario.cobrador"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Contraseña"}),e.jsx("input",{type:"password",className:"w-full p-2 border rounded-lg bg-slate-50",value:l.password,onChange:s=>u({...l,password:s.target.value}),placeholder:"Mínimo 4 caracteres"})]})]}),e.jsx("button",{type:"button",onClick:G,className:"bg-slate-900 text-white px-6 py-2 rounded-lg font-bold text-sm",children:"Registrar usuario de acceso"})]}),e.jsxs("div",{className:"mt-4 border-t border-slate-100 pt-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Seguridad e inicio de sesión"}),e.jsx("p",{className:"text-xs text-slate-500 mb-3",children:"Estas credenciales se usan para acceder al panel en este dispositivo."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Usuario administrador"}),e.jsx("input",{type:"text",className:"w-full p-2 border rounded-lg bg-slate-50",value:a.securityUser,onChange:s=>d({...a,securityUser:s.target.value}),placeholder:"admin"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Contraseña / PIN"}),e.jsx("input",{type:"password",className:"w-full p-2 border rounded-lg bg-slate-50",value:a.securityPassword,onChange:s=>d({...a,securityPassword:s.target.value}),placeholder:"••••••"}),e.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Protege solo este dispositivo. Usa también el bloqueo del sistema operativo."})]})]})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between border-t border-slate-100 pt-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-700",children:"Notificación GPS para Rutas"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Si está activo, al iniciar una ruta se mostrará alerta de GPS/navegación."})]}),e.jsx("button",{type:"button",onClick:()=>x({...t,enableRouteGpsNotification:!t.enableRouteGpsNotification}),className:`w-11 h-6 flex items-center rounded-full px-1 transition-colors ${t.enableRouteGpsNotification?"bg-emerald-500":"bg-slate-300"}`,children:e.jsx("div",{className:`w-4 h-4 bg-white rounded-full shadow transform transition-transform ${t.enableRouteGpsNotification?"translate-x-4":"translate-x-0"}`})})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-700",children:"Incluir cuotas futuras en Rutas"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Si está activo, la Ruta Inteligente mostrará todas las cuotas pendientes, no solo las vencidas hoy."})]}),e.jsx("button",{type:"button",onClick:()=>x({...t,includeFutureInstallmentsInRoutes:!t.includeFutureInstallmentsInRoutes}),className:`w-11 h-6 flex items-center rounded-full px-1 transition-colors ${t.includeFutureInstallmentsInRoutes?"bg-blue-600":"bg-slate-300"}`,children:e.jsx("div",{className:`w-4 h-4 bg-white rounded-full shadow transform transition-transform ${t.includeFutureInstallmentsInRoutes?"translate-x-4":"translate-x-0"}`})})]}),e.jsx("button",{type:"submit",className:"mt-4 bg-blue-600 text-white px-6 py-2 rounded-lg font-bold",children:"Guardar Cambios"})]})]}),e.jsxs(g,{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:"Gestión de Cobradores"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("form",{onSubmit:I,className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Nombre del Cobrador"}),e.jsx("input",{type:"text",className:"w-full p-2 border rounded-lg bg-slate-50",value:i.name,onChange:s=>p({...i,name:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Teléfono"}),e.jsx("input",{type:"text",className:"w-full p-2 border rounded-lg bg-slate-50",value:i.phone,onChange:s=>p({...i,phone:s.target.value})})]}),e.jsx("button",{type:"submit",className:"bg-emerald-600 text-white px-6 py-2 rounded-lg font-bold",children:"Agregar Cobrador"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Listado"}),c.length===0?e.jsx("p",{className:"text-sm text-slate-400",children:"No hay cobradores registrados."}):e.jsx("ul",{className:"text-sm divide-y divide-slate-100",children:c.map(s=>{const o=R===s.id;return e.jsx("li",{className:"py-2 flex flex-col gap-1",children:o?e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",className:"flex-1 p-2 border rounded-lg bg-slate-50",value:n.name,onChange:b=>m({...n,name:b.target.value}),placeholder:"Nombre del cobrador"}),e.jsx("input",{type:"text",className:"w-40 p-2 border rounded-lg bg-slate-50",value:n.phone,onChange:b=>m({...n,phone:b.target.value}),placeholder:"Teléfono"})]}),e.jsxs("div",{className:"flex gap-2 justify-end text-xs",children:[e.jsx("button",{type:"button",onClick:()=>F(s.id),className:"px-3 py-1 rounded-lg bg-emerald-600 text-white font-semibold",children:"Guardar"}),e.jsx("button",{type:"button",onClick:()=>{h(""),m({name:"",phone:""})},className:"px-3 py-1 rounded-lg bg-slate-200 text-slate-700 font-semibold",children:"Cancelar"})]})]}):e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-slate-800",children:s.name}),e.jsx("p",{className:"text-xs text-slate-500",children:s.phone})]}),e.jsxs("div",{className:"flex gap-2 text-xs",children:[e.jsx("button",{type:"button",onClick:()=>U(s),className:"px-3 py-1 rounded-lg bg-slate-900 text-white font-semibold",children:"Editar"}),e.jsx("button",{type:"button",onClick:()=>D(s.id),className:"px-3 py-1 rounded-lg bg-red-100 text-red-700 font-semibold",children:"Eliminar"})]})]})},s.id)})})]})]})]}),e.jsxs(g,{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-1",children:"Asignación de Clientes a Cobradores"}),e.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Elige un cobrador para cada cliente. El cambio se guarda inmediatamente cuando seleccionas un cobrador."}),N.length===0?e.jsx("p",{className:"text-sm text-slate-400",children:"No hay clientes registrados."}):c.length===0?e.jsx("p",{className:"text-sm text-slate-400",children:"Primero agrega al menos un cobrador para poder asignarlo."}):e.jsx("div",{className:"overflow-x-auto max-h-[360px]",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 text-left",children:"Cliente"}),e.jsx("th",{className:"p-2 text-left",children:"Teléfono"}),e.jsx("th",{className:"p-2 text-left",children:"Dirección"}),e.jsx("th",{className:"p-2 text-left",children:"Cobrador asignado"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:N.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 font-medium text-slate-800",children:s.name}),e.jsx("td",{className:"p-2 text-slate-500",children:s.phone||"N/A"}),e.jsx("td",{className:"p-2 text-slate-500 truncate max-w-[220px]",children:s.address||"N/A"}),e.jsx("td",{className:"p-2",children:e.jsxs("select",{className:"w-full p-2 border rounded-lg bg-slate-50 text-sm",value:s.collectorId||"",onChange:o=>w(s.id,o.target.value),children:[e.jsx("option",{value:"",children:"Sin asignar"}),c.map(o=>e.jsx("option",{value:o.id,children:o.name},o.id))]})})]},s.id))})]})})]})]})}export{T as SettingsView,T as default};
